## 前言
这是一个个人博客，分享发点自己东西，以及用来记录自己的工作中碰到的坑，由于只花了七八天的时间，比较忙，也还没来得及正式部署，后面会慢慢完善

## 后台
- 后台采用koa2+mongoose,以及一些常用第三方中间件(有几个中间件自己写了，包括jwt的验证，跨域的设置、提供jsonp等)
- 后台提供restful形式以及graphql形式的api两种模式
- 后台的调试：由于想不通过webpack的转换，直接打断点自己写的代码，node官网提供了一种不需要全部以.mjs的方式，但我按它的步骤来搞不定了，后来我采用自己写的代码全部以.mjs格式，这样就能直接在vscode里打断点调试，并提供了一个脚本来把所有的文件转换成webpack能打包的.js文件，这样就能满足调试，构建等需求
- 尽量采用小的模块，基本就是一个小单位（函数，对象）作为一个模块写在单独一个文件里，再在外面写个index文件统一导出
- 需求：提供前端，小程序等端的数据服务
- 进度：数据库的增删改查基本已经写完
- 目前存在的问题：服务端的优化（比如几个异步没啥先后关系，可以合并下，数据库的操作也可以合并下，比如插入/删除多条数据）；restful的路由的定义还没明确化；参数的格式和传递形式还没明确化

## 前端
- 前端采用react，react-router，mobx，sass
- api目前还是采用restful形式的
- 布局-禁用float，用flex
- 需求：
    - 提供展示文章，以及一个个人的收藏音乐，小短片的页面
    - 提供编辑，评论，查看的功能
- 进度：文章列表，文章详情，登录登页面已经写完
- 问题：还没做成响应式的，以及一些样式需要美化，以及后面的功能需要完善


## 小程序
- 直接采用官网的写法（而不是类似于mpvue之类的），这样能了解它小程序原本提供的功能和写法
- 进度：一样只写了文章列表和文章详情

## git仓库
- 自己再服务器部署了一个git私有仓库，用gitolite来管理用户和仓库
- github的话目前不想上传上去

## 部署
- node后台:没有一些进程管理不太方便，去尝试了一下pm2，但arch发行版上pm2貌似不允许，用不了；又去尝试利用githooks来部署，但是这个管理仓库的用户没有任何权限，没法执行些系统命令；最后在有sudo权限的用户下，用systemd来管理node进程，由于构建花不了多少时间，git仓库只存代码，不用它来部署了，直接在本地构建好，打包出来scp上去来部署，这样服务器上也不需要去装乱七八糟的依赖
- 前端:跟node一样，在本地构建好scp上去直接部署
- 小程序:经过尝试了多次ICP备案，但没成功，所以没法部署到线上（之后有时间再处理了）

## Nginx
由于graphql，小程序等都要求https的，所以为了高配置性，直接用Nginx来解决跨域，https(certbot)




